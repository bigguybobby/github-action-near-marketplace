name: 'NEAR Marketplace Auto-Submit'
description: 'Automatically submit tools and packages to NEAR Marketplace on release'
author: 'NEAR Marketplace Team'

branding:
  icon: 'upload-cloud'
  color: 'blue'

inputs:
  api-key:
    description: 'NEAR Marketplace API key (use secrets.NEAR_MARKET_API_KEY)'
    required: true

  project-path:
    description: 'Path to project root (containing package.json/pyproject.toml/Cargo.toml)'
    required: false
    default: '.'

  name:
    description: 'Override project name (defaults to package metadata)'
    required: false

  description:
    description: 'Override project description'
    required: false

  long-description:
    description: 'Extended markdown description shown on listing page'
    required: false

  tags:
    description: 'Comma-separated tags (e.g., "automation,ai,tools")'
    required: false

  category:
    description: 'Project category (e.g., "development", "productivity", "ai", "blockchain")'
    required: false
    default: 'development'

  homepage:
    description: 'Project homepage URL'
    required: false

  repository:
    description: 'Repository URL (defaults to GitHub repo)'
    required: false

  version:
    description: 'Version override (defaults to release tag or package version)'
    required: false

  license:
    description: 'SPDX license identifier (e.g., MIT, Apache-2.0)'
    required: false
    default: 'MIT'

  changelog:
    description: 'Release changelog / what-is-new text (shown on listing page)'
    required: false

  pricing:
    description: 'Pricing model: free, freemium, paid'
    required: false
    default: 'free'

  min-near-version:
    description: 'Minimum NEAR CLI/SDK version required (e.g., "2.0.0")'
    required: false

  update-existing:
    description: 'Update existing listing if found (true/false)'
    required: false
    default: 'true'

  dry-run:
    description: 'Test mode â€” validate metadata but do not submit (true/false)'
    required: false
    default: 'false'

  validate-only:
    description: 'Run schema validation only, exit 0 if valid (true/false)'
    required: false
    default: 'false'

  fail-on-warning:
    description: 'Treat warnings (missing optional fields) as errors (true/false)'
    required: false
    default: 'false'

  marketplace-url:
    description: 'Override marketplace API base URL (for testing/staging)'
    required: false
    default: 'https://market.near.ai/v1'

outputs:
  listing-id:
    description: 'NEAR Marketplace listing ID'

  listing-url:
    description: 'Public URL of the marketplace listing'

  status:
    description: 'Submission status (created, updated, dry-run, validated, error)'

  warnings:
    description: 'JSON array of warning messages (missing optional fields)'

runs:
  using: 'node20'
  main: 'src/index.js'
